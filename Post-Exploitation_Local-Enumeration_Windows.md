# Hostname

## Meterpreter

``` getuid ```

## Command Prompt (DOS Prompt)

``` systeminfo ```

# OS Name

## Meterpreter

``` getuid ```

## Command Prompt (DOS Prompt)

``` systeminfo ```

# OS Build / Service Pack

## Meterpreter

``` getuid ```

``` cat C:\Windows\System32\eula.txt ```

## Command Prompt (DOS Prompt)

``` systeminfo ```

``` type C:\Windows\System32\eula.txt ```

# OS Architecture

## Meterpreter

``` getuid ```

## Command Prompt (DOS Prompt)

``` systeminfo ```

# Installed Updates/Hotfixes

## Command Prompt (DOS Prompt)

``` systeminfo ```

``` wmic qfe get Caption,Description,HotFixID,InstalledOn ```

# Domain

## Meterpreter

``` getuid ```

# Network Information

## ARP
|Command|Description|
|--- |--- |
|```arp -a```| Shows all discovered MAC Addresses|

## IP Address / IPv6 Address

|Command|Description|
|--- |--- |
|```ipconfig /all```| Shows IP Address Info for all interfaces (Includes ARP info) |
|```route print```| Shows all routes on the local device|
|``` systeminfo ```| Shows system specific information to specific adapters |

## Listening Services / Active Connections

|Command|Description|
|--- |--- |
|```netstat -ano```| Lists open connections and services currently listening |

### DHCP Server

#### Command Prompt (DOS Prompt)

``` systeminfo ```

## Firewall Configuration

|Command|Description|Addtl. Notes|
|--- |--- |--- |
|```netsh firewall show state```| show Windows firewall state| Use on old machines (XP,Vista,7,etc.) |
|```netsh advfirewall firewall state```| Show Windows Firewall State||
|```netsh advfirewall show allprofiles```| Shows available Windows Firewall Profiles||

### PowerShell
|Command|Description|
|```Get-NetFirewallRule -All```|Shows All Windows Firewall rules in console|

### Export Firewall Configuration

#### To Console

```netsh advfirewall firewall dump```
```netsh firewall dump```

#### To File

##### Netsh

```netsh advfirewall export $directory\filename.wfw```

##### Can use PowerShell to export using Firewall-Manager Module if scripts are not controlled and export to JSON/CSV file

## Domain

# Virtualization Technologies

## Meterpreter

|||
|--- |--- |
|post/windows/gather/checkvm||

## Command Prompt (DOS Prompt)

``` systeminfo ```

# Users and Groups

## Meterpreter

``` getuid ```

## Command Prompt (DOS Prompt)

| Command | Description |
|--- |--- |
|``` net localgroup ``` | Shows all local groups|
|``` net localgroup $GroupName ``` | Shows description and members|

### Currently Logged On Users

### Meterpreter

### Note: You must background your current meterpreter session to use post exploit modules

``` use post/windows/gather/enum_logged_on_users ```

``` set SESSION $meterpreter_session_number ```

### Command Prompt (DOS Prompt)

| Command | Description|
|---  |---  |
| ``` whoami ``` | Shows who YOU are on the system |
| ``` query user ```| Lists users that are logged onto the system |
| ``` net user ```| Shows all users on the local device (helpful discovering roaming profiles) |
| ``` net user $username ```| Gives additional information about the specified user account (Group Memberships (Local and Global Groups), Allowed workstations, Logon scripts, Home directory, User Profile, Logon Hours) |

# Privileges

## Meterpreter

``` getprivs ```

## Command Prompt (DOS Prompt)

|Command | Description|
|--- |--- |
|``` whoami /priv ``` | Lists privileges|

# Logging configuration

## SysMon

# Processes and Services

## Meterpreter

``` ps ```

## Command Line
|Command|Description|
|---|---|
|``` net start ```|Shows Started Windows Services|
|```wmic service list brief```|Shows installed, startup, status, and health of services|
|```wmic service list FULL ```||
|```wmic service list SYSTEM ```||
|```tasklist```||
|```tasklist /SVC```||
|```schtasks /query /fo LIST```|Shows Status,Logon Mode, Status...|
|```schtasks /query /fo LIST /v```|Full path is in the "Task to Run:" line (filter with select-string) shows all what no /v shows|
|```sc query state=all```|Shows information for all services (active and inactive|
|```sc query $servicename```|Shows information for the service with the specified Service Name|
|```sc query type=service```|Shows information for all active services|
|```winpeas.exe quiet servicesinfo```|Gather Services Information with WinPEAS|

# Automation

## Meterpreter
|||
|--- |--- |
|post/windows/gather/win_privs|
|post/windows/gather/enum_applications|
|post/windows/gather/enum_patchs|



## JAWS - Just Another Windows (Enum) Script


|Jaws||
|--- |--- |
|https://github.com/411Hall/JAWS||
|Written in PowerShell 2.0||
|powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename $thing.txt||

## WinPEASS - 

|WinPEASS||
|--- |--- |
|https://github.com/carlospolop/PEASS-ng||
|Comes in both compiled (exe) and batch file||
|GitHub repo also contains LinPEASS||
